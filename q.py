[DEBUG] build_per_gray_y0 (component='Cx', pattern='W')
  X_mat shape: (256, 18)
  y_vec shape: (256,)
  groups shape: (256,)
  unique pk in groups: [500]
  inferred panel_onehot length: 5
  tail pattern_onehot sample(last row): [1. 0. 0. 0.]

  sample row @idx=0   : [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 1.0000, 0.0000, 0.0000, 0.0000, ..., 0.0000, 0.0000, 0.0000, 60.0000, 25.0000, 0.0000, 1.0000, 0.0000, 0.0000, 0.0000] (len=18), y=0.228300, pk=500
  sample row @idx=128: [0.2193, 0.7849, 0.2193, 0.7849, 0.2193, 0.7849, 1.0000, 0.0000, 0.0000, 0.0000, ..., 0.0000, 0.0000, 0.0000, 60.0000, 25.0000, 0.5020, 1.0000, 0.0000, 0.0000, 0.0000] (len=18), y=0.288000, pk=500
  sample row @idx=-1  : [1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 0.0000, 0.0000, 0.0000, ..., 0.0000, 0.0000, 0.0000, 60.0000, 25.0000, 1.0000, 1.0000, 0.0000, 0.0000, 0.0000] (len=18), y=0.289900, pk=500

[DEBUG] Last 10 rows (features tail & y):
  idx=   246 | y=0.289500 | pk=500 | tail10=(0.0000, 0.0000, 0.0000, 60.0000, 25.0000, 0.9647, 1.0000, 0.0000, 0.0000, 0.0000)
  idx=   247 | y=0.289500 | pk=500 | tail10=(0.0000, 0.0000, 0.0000, 60.0000, 25.0000, 0.9686, 1.0000, 0.0000, 0.0000, 0.0000)
  idx=   248 | y=0.289600 | pk=500 | tail10=(0.0000, 0.0000, 0.0000, 60.0000, 25.0000, 0.9725, 1.0000, 0.0000, 0.0000, 0.0000)
  idx=   249 | y=0.289700 | pk=500 | tail10=(0.0000, 0.0000, 0.0000, 60.0000, 25.0000, 0.9765, 1.0000, 0.0000, 0.0000, 0.0000)
  idx=   250 | y=0.289700 | pk=500 | tail10=(0.0000, 0.0000, 0.0000, 60.0000, 25.0000, 0.9804, 1.0000, 0.0000, 0.0000, 0.0000)
  idx=   251 | y=0.289800 | pk=500 | tail10=(0.0000, 0.0000, 0.0000, 60.0000, 25.0000, 0.9843, 1.0000, 0.0000, 0.0000, 0.0000)
  idx=   252 | y=0.289900 | pk=500 | tail10=(0.0000, 0.0000, 0.0000, 60.0000, 25.0000, 0.9882, 1.0000, 0.0000, 0.0000, 0.0000)
  idx=   253 | y=0.289900 | pk=500 | tail10=(0.0000, 0.0000, 0.0000, 60.0000, 25.0000, 0.9922, 1.0000, 0.0000, 0.0000, 0.0000)
  idx=   254 | y=0.289900 | pk=500 | tail10=(0.0000, 0.0000, 0.0000, 60.0000, 25.0000, 0.9961, 1.0000, 0.0000, 0.0000, 0.0000)
  idx=   255 | y=0.289900 | pk=500 | tail10=(0.0000, 0.0000, 0.0000, 60.0000, 25.0000, 1.0000, 1.0000, 0.0000, 0.0000, 0.0000)

[DEBUG] build_multitarget_flat(include=Y0,Y1,Y2)
  X_flat shape: (1, 1543)  # 6*256 + |panel_onehot| + 2
  Y_flat shape: (1, 3339)  # 3072 + 255 + 12 per PK
